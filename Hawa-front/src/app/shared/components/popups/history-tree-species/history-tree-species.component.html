<div class="wrapper-popup overlay-popup d-flex justify-content-center align-items-center">
    <div class="popup p-4 shadow-box">
        <div class="close-icon cursor-pointer shadow-box d-flex justify-content-center align-items-center"
            (click)="closePopup()">
            <i class="fa fa-times" aria-hidden="true"></i>
        </div>
        <div class="popup-content px-4 py-2">
            <div>
                <div class="text-uppercase font-size--20px d-flex w-100">Lịch sử của lô {{createTreeSpecModel.plotCode}}
                </div>
            </div>
            <div class="w-100 pt-2 position-relative table-responsive">
                <table class="w-100">
                    <thead>
                        <tr>
                            <th>
                                <span class="d-flex justify-content-start">
                                    <div class="pr-2">
                                        <div>STT</div>
                                        <div>(No.)</div>
                                    </div>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('ICTreeSpec.ICTreeSpecName')">
                                    <div class="pr-2">
                                        <div>Loài cây</div>
                                        <div class="font-size--10px">(Species)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'ICTreeSpec.ICTreeSpecName Asc' && filterModel.sorting != 'ICTreeSpec.ICTreeSpecName Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICTreeSpec.ICTreeSpecName Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICTreeSpec.ICTreeSpecName Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th class="plot__width">
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('GEPlotCode')">
                                    <div class="pr-2">
                                        <div>Lô</div>
                                        <div class="font-size--10px">(Lot)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'GEPlotCode Asc' && filterModel.sorting != 'GEPlotCode Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'GEPlotCode Asc'" class="fa fa-caret-down"
                                            style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'GEPlotCode Desc'" class="fa fa-caret-up"
                                            style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('ICForestPlotHistoryVolumnPerPlot')">
                                    <div class="pr-2">
                                        <div>Trữ lượng (m3)</div>
                                        <div class="font-size--10px">(Volume)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'ICForestPlotHistoryVolumnPerPlot Asc' && filterModel.sorting != 'ICForestPlotHistoryVolumnPerPlot Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryVolumnPerPlot Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryVolumnPerPlot Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('ICForestPlotHistoryArea')">
                                    <div class="pr-2">
                                        <div>Diện tích (ha)</div>
                                        <div class="font-size--10px">(Area)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'ICForestPlotHistoryArea Asc' && filterModel.sorting != 'ICForestPlotHistoryArea Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryArea Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryArea Desc'" class="fa fa-caret-up"
                                            style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('ICForestPlotHistoryPlantingYear')">
                                    <div class="pr-2">
                                        <div>Tuổi</div>
                                        <div class="font-size--10px">(Age)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'ICForestPlotHistoryPlantingYear Asc' && filterModel.sorting != 'ICForestPlotHistoryPlantingYear Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryPlantingYear Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryPlantingYear Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('ICForestPlotHistoryPlantingDate')">
                                    <div class="pr-2">
                                        <div>Năm trồng</div>
                                        <div class="font-size--10px">(Planting Year)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'ICForestPlotHistoryPlantingDate Asc' && filterModel.sorting != 'ICForestPlotHistoryPlantingDate Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryPlantingDate Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryPlantingDate Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('ICForestCert.ICForestCertName')">
                                    <div class="pr-2">
                                        <div>Chứng chỉ</div>
                                        <div class="font-size--10px">(Certificate)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'ICForestCert.ICForestCertName Asc' && filterModel.sorting != 'ICForestCert.ICForestCertName Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestCert.ICForestCertName Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestCert.ICForestCertName Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('APActor.APActorName')">
                                    <div class="pr-2">
                                        <div>Chủ rừng</div>
                                        <div class="font-size--10px">(Forest owner)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'APActor.APActorName Asc' && filterModel.sorting != 'APActor.APActorName Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'APActor.APActorName Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'APActor.APActorName Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('APActor.APActorType.APActorTypeName')">
                                    <div class="pr-2">
                                        <div>Loại chủ rừng</div>
                                        <div class="font-size--10px">(Forest owner type)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'APActor.APActorType.APActorTypeName Asc' && filterModel.sorting != 'APActor.APActorType.APActorTypeName Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'APActor.APActorType.APActorTypeName Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'APActor.APActorType.APActorTypeName Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('ICForestPlotHistoryReliability')">
                                    <div class="pr-2">
                                        <div>Độ tin cậy</div>
                                        <div class="font-size--10px">(Reliability level)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'ICForestPlotHistoryReliability Asc' && filterModel.sorting != 'ICForestPlotHistoryReliability Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryReliability Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryReliability Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('ADUser.ADUserOrganizationName')">
                                    <div class="pr-2">
                                        <div>Người thay đổi</div>
                                        <div class="font-size--10px">(User change)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'ADUser.ADUserOrganizationName Asc' && filterModel.sorting != 'ADUser.ADUserOrganizationName Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ADUser.ADUserOrganizationName Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ADUser.ADUserOrganizationName Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                            <th>
                                <span class="d-flex justify-content-start cursor-pointer"
                                    (click)="orderByField('ICForestPlotHistoryCreatedDate')">
                                    <div class="pr-2">
                                        <div>Ngày thay đổi</div>
                                        <div class="font-size--10px">(Date change)</div>
                                    </div>
                                    <span>
                                        <i *ngIf="filterModel.sorting == '' || (filterModel.sorting != 'ICForestPlotHistoryCreatedDate Asc' && filterModel.sorting != 'ICForestPlotHistoryCreatedDate Desc')"
                                            class="fa fa-sort" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryCreatedDate Asc'"
                                            class="fa fa-caret-down" style="color: #ffff;"></i>
                                        <i *ngIf="filterModel.sorting == 'ICForestPlotHistoryCreatedDate Desc'"
                                            class="fa fa-caret-up" style="color: #ffff;"></i>
                                    </span>
                                </span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of pagedResult.items; let i = index">
                            <td>{{i+1}}</td>

                            <td [title]="item?.treeSpec?.name ? item?.treeSpec?.name : ''">{{item?.treeSpec?.name}}</td>

                            <td>
                                <div class="d-flex justify-content-between">
                                    <div class="plot-value__pad" [title]="item?.plotCode ? item?.plotCode : ''">
                                        {{item?.plotCode}}
                                    </div>
                                </div>
                            </td>
                            <td class="text-right pr-5" [title]="item?.volumnPerPlot ? item?.volumnPerPlot : ''">
                                {{item?.volumnPerPlot | thousandSeparate}}</td>
                            <td class="text-right pr-5" [title]="item?.area ? item?.area : ''">
                                {{item?.area | thousandSeparate}}</td>
                            <td class="text-right pr-5" [title]="item?.plantingYear ? item?.plantingYear : ''">
                                {{item?.plantingYear}}
                            </td>
                            <td class="text-right pr-5"
                                [title]="item?.plantingDate ? (item?.plantingDate*1000 | date:'dd/MM/yyyy': '+0000') : ''">
                                {{item?.plantingDate*1000 | date:'dd/MM/yyyy': '+0000'}}</td>
                            <td [title]="item?.forestCert?.text ? item?.forestCert?.text : ''">
                                {{item?.forestCert?.text}}</td>
                            <td>
                                <a class="cursor-pointer">{{item?.actor?.name}}</a>
                            </td>
                            <td [title]="item?.actorType?.name ? item?.actorType?.name : ''">{{item?.actorType?.name}}
                            </td>
                            <td>
                                <ng-container *ngIf="item.reliability && item.reliability.text">
                                    <div [class.reliability-low]="item?.reliability?.key === 'LowRisk'"
                                        [class.reliability-moderate-risk]="item?.reliability?.key === 'ModerateRisk'"
                                        [class.reliability-high-risk]="item?.reliability?.key === 'HighRisk'"
                                        [class.reliability-legal]="item?.reliability?.key === 'Legal'"
                                        [title]="item?.reliability?.text ? item?.reliability?.text : ''">
                                        {{item?.reliability?.text}}
                                    </div>
                                </ng-container>
                            </td>
                            <td [title]="item?.user?.organizationName ? item?.user?.organizationName : ''">
                                {{item?.user?.organizationName}}</td>
                            <td [title]="item?.createDate ? (item?.createDate*1000 | date:'dd/MM/yyyy': '+0000') : ''">
                                {{item?.createDate*1000 | date:'dd/MM/yyyy': '+0000'}}</td>
                        </tr>
                    </tbody>
                </table>
                <div *ngIf="pagedResult && (pagedResult.items || []).length === 0" class="text-center p-3">Không có dữ
                    liệu</div>
                <app-pagination [(pagedResult)]="pagedResult" (pagedResultChange)="pagedResultChange($event)">
                </app-pagination>
                <loading *ngIf="loading"></loading>
            </div>
            <div class="d-flex justify-content-center mt-5">
                <button nbButton class="text-uppercase cursor-pointer abort-bg ml-1"
                    (click)="closePopup()">đóng</button>
            </div>
        </div>
    </div>
</div>